# Writeup 3 - Operational Security and Social Engineering

Name: Tuan Le
Section: 0201

I pledge on my honor that I have not given or received any unauthorized assistance on this assignment or examniation.

Digital acknowledgement: Tuan Le

## Assignment Writeup

### Part 1 (40 pts)

The flag I found was CMSC389R-{d1gging_f0r_flag5_thr0ugh_1njec7ion}. To understand this problem, I had to do a lot of inital research on what DNS, nc (NetCat), and command injection. Through my research, I learned that command injection is an attack where the user executes arbitrary commands on the host operating system via a vulnerable application. The principle behind why this works is because the server is trusting the user to provide safe and valid inputs. Obviously, this is not always the case. It is never a good idea to give the user this high level of trust. Through Piazza, I learned that upon connecting to the server, the command '$ dig <user_input>' is executed. With proper input, this command would execute like normally intended to, with no extra side effects. However, the vulernability lies in the fact that the user can chain other operating system commands to this seemingly safe dig command. My thought process was to question how I can use this command injection to exploit the vulnerabiltiy. I discovered that when I run the given nc '1337bank.money 1337' command, the server requests me to provide a domain or ip address to connect to. Initally, I overlooked this and I just put in '1337bank.money' but I eventually realized that this entry point was where the attack would enter. With the help of Piazza, I performed the command 'nc 1337bank.money 1337; ls' which chained together the nc and ls command. This allowed me to list the files in the server. From seeing these files, I saw that there was a home directory. Naturally, I assumed this directory would hold something interesting. I then did 'nc 1337bank.money 1337; cd home; ls' and I saw that there was a sole text file called 'flag.txt' which I knew contained the flag. Thus, I performed the final command 'nc 1337bank.money 1337; cd home; cat flag.txt' which finally gave me the flag. v0idcache could have prevented this vulnerability by sanitizing the input. By this, she could have scrubed the input values for potentially dangerous characters like ';', '&', and '|'. Doing so would prevent the user from chaining together commands. Additionally, v0idcache could have also restricted input by testing it against a regular expression of safe characters. This would also detect the use of malicious characters and would help prevent commands.

### Part 2 (60 pts)

The purpose of this python script is to implement an interactive shell to leverage the command injection expliotation of v0idcache's server. My script allows for 4 actions. The first action is 'shell' which drops into an interactive shell and allows users to gracefully exit. The second command is 'pull <remote-path> <local-path>' to download files. The third is 'help' which shows the help menu showing all the commands. Lastly, 'quit' just exits the shell. Upon entering one of these commands, my script establishes a socket connection to the server using the host as "1337bank.money" and port 1337. The connection is a back and forth exchange where the user sends data to the server and receives data back. The command inputs are handled within my '__main__'. If the command is 'quit', the shell just exits. If the command is 'help', the help menu is displayed. If the command is 'shell' my script executes my execute_shell function. This function allows the user to send in unix commands, one line at a time. It keeps track of the directoies that the user cd's into so the user can freely move in and out of directories. If the command is 'pull <remote-path> <local-path>' then my execute_pull function is performed. This function goes to the location of the <remote-path>, cat's the text into a buffer, then writes that buffer to a new file that is <local-path>. Overall, my code consists of the '__main__' portion and my two functions: execute_shell and execute_pull.